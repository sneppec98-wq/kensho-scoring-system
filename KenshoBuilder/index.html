<!DOCTYPE html>
<html lang="id">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Kensho Builder Pro - Master Template</title>

    <script src="https://cdn.tailwindcss.com"></script>
    <script src="https://cdn.jsdelivr.net/npm/interactjs/dist/interact.min.js"></script>
    <script src="https://www.gstatic.com/firebasejs/9.22.0/firebase-app-compat.js"></script>
    <script src="https://www.gstatic.com/firebasejs/9.22.0/firebase-firestore-compat.js"></script>
    <script src="https://html2canvas.hertzen.com/dist/html2canvas.min.js"></script>

    <link rel="stylesheet" href="css/builder.css">

    <style>
        .badge-version {
            display: inline-block;
            padding: 2px 8px;
            background: rgba(59, 130, 246, 0.1);
            color: #3b82f6;
            border: 1px solid rgba(59, 130, 246, 0.2);
            border-radius: 6px;
            font-size: 0.55rem;
            font-weight: 800;
            letter-spacing: 0.05em;
            text-transform: uppercase;
        }
    </style>
</head>

<body>
    <!-- TOP TOOLBAR -->
    <div class="top-toolbar">
        <div class="toolbar-group">
            <div class="bg-slate-100 p-1 rounded-lg border border-slate-200">
                <img src="../kensho-logo.png" alt="Logo" class="w-6 h-6 object-contain">
            </div>
            <span class="text-slate-900 font-black text-xs tracking-widest ml-1">KENSHO BUILDER</span>
            <div class="ml-4 flex items-center gap-2 px-3 py-1 bg-slate-50 border border-slate-200 rounded-full">
                <div id="activeTemplateDot" class="w-2 h-2 rounded-full bg-slate-300"></div>
                <span id="activeTemplateName"
                    class="text-[10px] font-bold text-slate-500 uppercase tracking-wider">Draft Template</span>
            </div>
        </div>

        <div class="toolbar-group ml-auto">
            <button onclick="saveProgress()" id="saveProgressBtn"
                class="bg-emerald-500 hover:bg-emerald-600 text-white text-[10px] font-black py-2 px-5 rounded-full flex items-center gap-2 transition-all opacity-50 cursor-not-allowed"
                disabled>
                SAVE PROGRESS
            </button>
            <button onclick="exportAsImage()"
                class="bg-blue-500 hover:bg-blue-600 text-white text-[10px] font-black py-2 px-5 rounded-full shadow-lg shadow-blue-500/20 transition-all">
                EKSPOR PNG
            </button>
        </div>
    </div>

    <!-- MAIN INTERFACE -->
    <div class="flex">
        <!-- SIDEBAR -->
        <div class="sidebar">
            <a href="../dashboard.html" class="side-icon-btn" title="Back to Dashboard">
                <svg class="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2"
                        d="M10 19l-7-7m0 0l7-7m-7 7h18" />
                </svg>
            </a>
            <div class="badge-version my-2">STUDIO v2.0</div>

            <div class="w-full h-px bg-slate-200 my-2"></div>

            <div class="side-icon-btn" onclick="toggleFlyout('flyout-add', this)" title="Add Elements">
                <svg class="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 4v16m8-8H4" />
                </svg>
            </div>

            <div class="side-icon-btn" onclick="toggleFlyout('flyout-layout', this)" title="Layout Settings">
                <svg class="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M4 6h16M4 12h16M4 18h7" />
                </svg>
            </div>

            <div class="side-icon-btn" onclick="toggleFlyout('flyout-storage', this)" title="Cloud Storage">
                <svg class="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2"
                        d="M3 15a4 4 0 004 4h9a5 5 0 10-.1-9.999 5.002 5.002 0 10-9.78 2.096A4.001 4.001 0 003 15z" />
                </svg>
            </div>

            <div class="w-full h-px bg-slate-200 my-2"></div>

            <div class="side-icon-btn" onclick="undo()" title="Undo">
                <svg class="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2"
                        d="M3 10h10a8 8 0 018 8v2M3 10l6 6m-6-6l6-6" />
                </svg>
            </div>

            <div class="side-icon-btn" onclick="printDesignedBracket()" title="Print PDF" class="mt-auto">
                <svg class="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2"
                        d="M17 17h2a2 2 0 002-2v-4a2 2 0 00-2-2H5a2 2 0 00-2 2v4a2 2 0 002 2h2m2 4h6a2 2 0 002-2v-4a2 2 0 00-2-2H9a2 2 0 00-2 2v4a2 2 0 002 2zm8-12V5a2 2 0 00-2-2H9a2 2 0 00-2 2v4h10z" />
                </svg>
            </div>
        </div>

        <!-- CANVAS AREA -->
        <div id="canvas-container">
            <div id="canvas">
                <svg id="line-canvas"
                    style="position: absolute; top:0; left:0; pointer-events:none; width:100%; height:100%;"></svg>
            </div>
        </div>

        <!-- PROPERTY INSPECTOR -->
        <div id="propertySidebar" class="property-sidebar">
            <div class="flex items-center justify-between mb-6 pb-4 border-b border-slate-200">
                <h3 class="font-black text-xs tracking-widest text-slate-900">INSPECTOR</h3>
                <button onclick="closePropertySidebar()" class="text-slate-400 hover:text-slate-600">âœ•</button>
            </div>
            <div id="propContent">
                <!-- Properties injected via JS -->
            </div>
        </div>
    </div>

    <!-- FLYOUTS (MODIFIED PATHS/CLASSES) -->
    <!-- (Simplified for this demonstration, will include all logic in builder.js) -->

    <script src="js/builder.js"></script>
    <script type="module" src="../js/security-guard.js"></script>
</body>

</html>