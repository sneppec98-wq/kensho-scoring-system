<!DOCTYPE html>
<html lang="id">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Live Scoring | Kensho Tech</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link href="https://fonts.googleapis.com/css2?family=Plus+Jakarta+Sans:wght@400;500;600;700;800&display=swap"
        rel="stylesheet">
    <link rel="stylesheet" href="css/window-controls.css">
    <link rel="stylesheet" href="css/scoring.css">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.1/css/all.min.css">
</head>

<body class="h-screen overflow-hidden text-slate-100 bg-[#020617]">
    <script src="js/window-controls.js"></script>


    <!-- SIDEBAR REMOVED FOR SCORING CONSOLE FOCUS -->

    <!-- CONTENT -->
    <!-- CONTENT -->
    <main class="w-full h-screen p-4 md:p-8 flex flex-col overflow-hidden relative">
        <!-- BACK BUTTON REMOVED AS PER REQUEST -->

        <header class="flex justify-between items-center mb-6">
            <!-- LEFT: BREADCRUMB -->
            <div class="flex-1 flex items-center justify-start">
                <a href="scoring-home.html"
                    class="flex items-center gap-3 px-4 py-2 rounded-2xl bg-white/5 border border-white/5 hover:bg-white/10 hover:border-white/10 transition-all group">
                    <svg class="w-4 h-4 text-slate-400 group-hover:text-red-500 group-hover:-translate-x-1 transition-all"
                        fill="none" stroke="currentColor" viewBox="0 0 24 24">
                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="3" d="M15 19l-7-7 7-7" />
                    </svg>
                    <span
                        class="text-[10px] font-black uppercase tracking-widest text-slate-500 group-hover:text-slate-200 transition-colors">Pusat
                        Scoring</span>
                </a>
            </div>

            <!-- CENTER: CONTROL REGISTRY -->
            <div
                class="flex items-center gap-2 px-3 py-2 rounded-[2rem] bg-slate-900/50 backdrop-blur-xl border border-white/5 shadow-2xl mx-4">
                <!-- MODE SWITCH -->
                <div class="flex p-1 rounded-xl bg-black/40 border border-white/5 min-w-[180px]">
                    <button id="modeKumiteBtn" onclick="setScoringMode('kumite')"
                        class="flex-1 py-2 rounded-lg text-[8px] font-black uppercase tracking-widest transition-all mode-active">KUMITE</button>
                    <button id="modeKataBtn" onclick="setScoringMode('kata')"
                        class="flex-1 py-2 rounded-lg text-[8px] font-black uppercase tracking-widest transition-all text-slate-500">KATA</button>
                </div>



            </div>

            <!-- RIGHT: TATAMI BADGE -->
            <div class="flex-1 flex items-center justify-end gap-3">
                <!-- Sync Indicator -->
                <div id="syncBadge" onclick="window.syncAll()" title="Klik untuk sinkronisasi manual"
                    style="cursor: pointer"
                    class="flex items-center gap-2 px-3 py-2 rounded-xl bg-white/5 border border-white/5 text-[7px] font-black uppercase tracking-[0.2em] text-slate-500 transition-all hover:bg-white/10 active:scale-95">
                    <div id="syncDot" class="w-1.5 h-1.5 rounded-full bg-slate-500"></div>
                    <span id="syncText">Offline Mode</span>
                </div>

                <div
                    class="flex items-center gap-4 pl-6 pr-2 py-2 rounded-2xl bg-red-600/5 border border-red-500/10 shadow-[0_0_30px_rgba(220,38,38,0.05)] relative group overflow-hidden">
                    <div
                        class="absolute inset-0 bg-gradient-to-r from-transparent via-red-500/5 to-transparent -translate-x-full group-hover:translate-x-full transition-transform duration-1000">
                    </div>
                    <div class="text-right relative z-10">
                        <p
                            class="text-[7px] font-black uppercase opacity-40 tracking-[0.3em] leading-none mb-1 text-red-500">
                            Arena Aktif</p>
                        <p
                            class="text-xs font-black uppercase tracking-widest text-red-500 group-hover:scale-105 transition-transform">
                            TATAMI <span id="activeTatamiLabel" class="ml-1">-</span>
                        </p>
                    </div>
                    <div
                        class="w-8 h-8 rounded-xl bg-red-600/10 border border-red-500/20 flex items-center justify-center relative z-10">
                        <div class="w-1.5 h-1.5 rounded-full bg-red-500 animate-pulse"></div>
                    </div>
                </div>
            </div>
        </header>

        <div id="mainScoringGrid" class="flex-1 flex flex-col gap-2 overflow-hidden">
            <!-- TOP: MATCH STATUS & SCOREBOARD -->
            <div id="scoringMainArea"
                class="flex-1 flex flex-col space-y-2 overflow-y-auto custom-scrollbar transition-all duration-500 pr-2">
                <!-- SCOREBOARD SPLIT-PANEL -->
                <div class="flex-1 grid grid-cols-12 gap-0 rounded-[3rem] overflow-hidden shadow-2xl border border-white/5 relative bg-slate-900/40 backdrop-blur-xl mb-2"
                    style="display: flex;">
                    <!-- AKA PANEL (Default: RIGHT side to match monitor) -->
                    <div id="panelContainerAka" style="order: 3; flex: 1.5;"
                        class="col-span-12 md:col-span-5 flex flex-col items-center justify-between py-6 px-8 bg-red-950/20 relative group border-l border-white/5 premium-gradient-red overflow-hidden">
                        <!-- DECORATIVE GLOW -->
                        <div
                            class="absolute -top-24 -right-24 w-48 h-48 bg-red-600/10 blur-[80px] rounded-full pointer-events-none">
                        </div>

                        <!-- HANTEI BUTTON (Minimalist) -->
                        <button id="btnHanteiAka" onclick="setHanteiWinner('aka')"
                            class="absolute top-0 right-0 px-6 py-2.5 bg-red-600 shadow-[0_8px_20px_rgba(220,38,38,0.4)] text-white rounded-bl-[2rem] border-l border-b border-white/20 hidden transition-all hover:scale-105 active:scale-95 z-50">
                            <span class="text-[10px] font-black tracking-[0.2em] uppercase">Kachi</span>
                        </button>

                        <div
                            class="absolute top-0 right-0 w-full h-1.5 bg-gradient-to-l from-red-600 to-transparent shadow-[0_5px_20px_rgba(220,38,38,0.4)]">
                        </div>

                        <!-- TOP: Name & Label -->
                        <div id="panelAka" class="text-center w-full relative z-10">
                            <p class="text-[11px] font-black uppercase tracking-[0.5em] text-red-500/50 mb-1.5">
                                AKA</p>
                            <h2 id="nameAkaDisplay"
                                class="text-3xl font-black uppercase tracking-tight text-white truncate px-4 drop-shadow-lg">
                                ---</h2>
                            <p id="teamAkaDisplay"
                                class="text-[11px] font-black uppercase text-white/80 tracking-[0.2em] mt-1 truncate px-10">
                                ---</p>
                            <input type="text" id="inputKataAka" placeholder="Input Nama Kata"
                                oninput="checkKataShortcut(this)" onchange="broadcastData()"
                                class="w-auto min-w-[200px] bg-red-500/10 border border-red-500/20 rounded-2xl px-6 py-3 text-xs font-black uppercase tracking-widest text-red-400 mt-3 focus:bg-red-500/20 focus:border-red-500/50 focus:scale-105 focus:outline-none placeholder:text-red-500/30 transition-all text-center hidden shadow-inner">
                        </div>

                        <!-- CENTER: Score (Anchor) -->
                        <div id="scoreAka"
                            class="text-[180px] score-digit text-red-500 leading-none drop-shadow-[0_20px_60px_rgba(248,113,113,0.4)] select-none my-auto transition-all duration-300">
                            00</div>

                        <!-- BOTTOM: Controls -->
                        <div id="kumiteControlsAka" class="w-full relative z-10 space-y-4 px-4">
                            <!-- Score Buttons -->
                            <div class="grid grid-cols-4 gap-3">
                                <button onclick="addScore('aka', 1)"
                                    class="neu-button py-4 rounded-2xl group border-white/10">
                                    <span
                                        class="text-2xl font-black group-hover:scale-110 transition-transform text-red-400">+1</span>
                                </button>
                                <button onclick="addScore('aka', 2)"
                                    class="neu-button py-4 rounded-2xl group border-red-500/30">
                                    <span
                                        class="text-2xl font-black text-red-500 group-hover:scale-110 transition-transform">+2</span>
                                </button>
                                <button onclick="addScore('aka', 3)"
                                    class="neu-button py-4 rounded-2xl group border-red-500/50">
                                    <span
                                        class="text-2xl font-black text-red-600 group-hover:scale-110 transition-transform">+3</span>
                                </button>
                                <button onclick="addScore('aka', -1)"
                                    class="neu-button py-4 rounded-2xl group bg-white/5 opacity-40 border-white/5">
                                    <span
                                        class="text-2xl font-black text-slate-500 group-hover:scale-110 transition-transform">-1</span>
                                </button>
                            </div>

                            <!-- Penalty & Status Buttons -->
                            <div id="penAka" class="grid grid-cols-7 gap-1.5 md:gap-2">
                                <button id="senshuAka" onclick="setSenshu('aka')"
                                    class="py-4 rounded-xl neu-button text-[12px] font-black opacity-70 hover:opacity-100 transition-opacity">S</button>
                                <button onclick="togglePenalty('aka', 'c1')" id="c1Aka"
                                    class="penalty-btn neu-button py-4 rounded-xl text-[12px] font-black opacity-40">C1</button>
                                <button onclick="togglePenalty('aka', 'c2')" id="c2Aka"
                                    class="penalty-btn neu-button py-4 rounded-xl text-[12px] font-black opacity-40">C2</button>
                                <button onclick="togglePenalty('aka', 'c3')" id="c3Aka"
                                    class="penalty-btn neu-button py-4 rounded-xl text-[12px] font-black opacity-40">C3</button>
                                <button onclick="togglePenalty('aka', 'hc')" id="hcAka"
                                    class="penalty-btn neu-button py-4 rounded-xl text-[12px] font-black opacity-40">HC</button>
                                <button onclick="togglePenalty('aka', 'h')" id="hAka"
                                    class="penalty-btn neu-button py-4 rounded-xl text-[12px] font-black opacity-40">H</button>
                                <button id="vrAka" onclick="toggleVR('aka')"
                                    class="py-4 rounded-xl neu-button text-[12px] font-black opacity-50 text-yellow-500 transition-all hover:opacity-100">VR</button>
                            </div>
                        </div>

                        <!-- KATA CONTROLS AKA (Integrated) -->
                        <div id="kataControlsAka" class="hidden w-full relative z-10 space-y-4 px-2">
                            <div class="grid grid-cols-5 gap-3">
                                <input type="text" id="judgeBtnAka0" value="0.0"
                                    oninput="window.updateKataJudgeScoreManual(this, 'aka', 0)" onfocus="this.select()"
                                    inputmode="decimal"
                                    class="oled-panel rounded-2xl py-4 text-center text-lg font-black text-red-500 hover:glow-red focus:glow-red focus:ring-2 focus:ring-red-500/50 outline-none transition-all bg-transparent">
                                <input type="text" id="judgeBtnAka1" value="0.0"
                                    oninput="window.updateKataJudgeScoreManual(this, 'aka', 1)" onfocus="this.select()"
                                    inputmode="decimal"
                                    class="oled-panel rounded-2xl py-4 text-center text-lg font-black text-red-500 hover:glow-red focus:glow-red focus:ring-2 focus:ring-red-500/50 outline-none transition-all bg-transparent">
                                <input type="text" id="judgeBtnAka2" value="0.0"
                                    oninput="window.updateKataJudgeScoreManual(this, 'aka', 2)" onfocus="this.select()"
                                    inputmode="decimal"
                                    class="oled-panel rounded-2xl py-4 text-center text-lg font-black text-red-500 hover:glow-red focus:glow-red focus:ring-2 focus:ring-red-500/50 outline-none transition-all bg-transparent">
                                <input type="text" id="judgeBtnAka3" value="0.0"
                                    oninput="window.updateKataJudgeScoreManual(this, 'aka', 3)" onfocus="this.select()"
                                    inputmode="decimal"
                                    class="oled-panel rounded-2xl py-4 text-center text-lg font-black text-red-500 hover:glow-red focus:glow-red focus:ring-2 focus:ring-red-500/50 outline-none transition-all bg-transparent">
                                <input type="text" id="judgeBtnAka4" value="0.0"
                                    oninput="window.updateKataJudgeScoreManual(this, 'aka', 4)" onfocus="this.select()"
                                    inputmode="decimal"
                                    class="oled-panel rounded-2xl py-4 text-center text-lg font-black text-red-500 hover:glow-red focus:glow-red focus:ring-2 focus:ring-red-500/50 outline-none transition-all bg-transparent">
                            </div>
                            <div
                                class="p-3.5 rounded-2xl bg-red-600/10 border border-red-500/20 flex justify-between items-center shadow-inner">
                                <div class="flex flex-col">
                                    <span
                                        class="text-[10px] font-black uppercase tracking-[0.2em] text-red-500/50">TOTAL
                                        SCORE</span>
                                    <button onclick="window.checkKataAutoWinner()"
                                        class="text-[8px] font-black text-red-500/80 hover:text-red-400 text-left">AUTO-CALC</button>
                                </div>
                                <span id="kataTotalAka" class="text-2xl font-black text-red-500 score-digit">0.0</span>
                            </div>
                        </div>

                        <!-- KATA FLAG CONTROLS AKA -->
                        <div id="kataFlagControlsAka" class="hidden w-full relative z-10 space-y-3 px-4">
                            <p class="text-[8px] font-black uppercase tracking-widest text-red-500/50 text-center">
                                VOTING BENDERA AKA</p>
                            <div class="grid grid-cols-6 gap-2">
                                <button onclick="setKataFlagsAka(0)"
                                    class="flag-btn-aka py-3 rounded-xl bg-white/5 text-red-500 text-lg font-black border border-white/10 hover:border-red-500 hover:bg-red-500/20 transition-all"
                                    data-val="0">0</button>
                                <button onclick="setKataFlagsAka(1)"
                                    class="flag-btn-aka py-3 rounded-xl bg-white/5 text-red-500 text-lg font-black border border-white/10 hover:border-red-500 hover:bg-red-500/20 transition-all"
                                    data-val="1">1</button>
                                <button onclick="setKataFlagsAka(2)"
                                    class="flag-btn-aka py-3 rounded-xl bg-white/5 text-red-500 text-lg font-black border border-white/10 hover:border-red-500 hover:bg-red-500/20 transition-all"
                                    data-val="2">2</button>
                                <button onclick="setKataFlagsAka(3)"
                                    class="flag-btn-aka py-3 rounded-xl bg-white/5 text-red-500 text-lg font-black border border-white/10 hover:border-red-500 hover:bg-red-500/20 transition-all"
                                    data-val="3">3</button>
                                <button onclick="setKataFlagsAka(4)"
                                    class="flag-btn-aka py-3 rounded-xl bg-white/5 text-red-500 text-lg font-black border border-white/10 hover:border-red-500 hover:bg-red-500/20 transition-all"
                                    data-val="4">4</button>
                                <button onclick="setKataFlagsAka(5)"
                                    class="flag-btn-aka py-3 rounded-xl bg-white/5 text-red-500 text-lg font-black border border-white/10 hover:border-red-500 hover:bg-red-500/20 transition-all"
                                    data-val="5">5</button>
                            </div>
                        </div>
                    </div>

                    <!-- CENTER STRIP: TIMER & ROUND -->
                    <div id="panelContainerCenter" style="order: 2; flex: 1; min-width: 210px;"
                        class="col-span-12 md:col-span-2 flex flex-col items-center justify-start py-4 px-3 bg-slate-950/40 border-x border-white/5 relative overflow-hidden gap-2.5 backdrop-blur-xl">

                        <!-- DECORATIVE CENTER BACKGROUND -->
                        <div
                            class="absolute inset-0 bg-[radial-gradient(circle_at_center,_rgba(30,41,59,0.3)_0%,_transparent_70%)] pointer-events-none">
                        </div>
                        <div
                            class="absolute inset-0 bg-gradient-to-b from-blue-500/5 via-transparent to-red-500/5 pointer-events-none opacity-30">
                        </div>

                        <!-- 1. CATEGORY HEADER -->
                        <div class="relative z-10 w-full">
                            <div
                                class="bg-white/[0.03] border border-white/10 px-3 py-1.5 rounded-xl flex flex-col items-center shadow-xl backdrop-blur-md">
                                <p id="categoryDisplay"
                                    class="text-[10px] font-black tracking-[0.3em] text-slate-100 uppercase overflow-hidden whitespace-nowrap text-ellipsis max-w-full">
                                    KUMITE</p>
                                <div class="w-10 h-0.5 bg-red-500 mt-1 rounded-full opacity-40"></div>
                            </div>
                        </div>

                        <!-- 2. UTILITY STRIP -->
                        <div
                            class="relative z-10 flex items-center gap-2 bg-white/[0.03] p-1 rounded-[1.25rem] border border-white/5 shadow-inner">
                            <button onclick="flipPanels()" id="btnFlipPanels"
                                class="w-10 h-10 rounded-lg bg-white/5 text-purple-400 flex items-center justify-center hover:bg-purple-600 hover:text-white transition-all shadow-lg border border-white/5"
                                title="Tukar Posisi AKA/AO">
                                <svg class="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2.5"
                                        d="M8 7h12m0 0l-4-4m4 4l-4 4m0 6H4m0 0l4 4m-4-4l4-4" />
                                </svg>
                            </button>
                            <button onclick="handleMonitor()" id="btnMonitor"
                                class="w-10 h-10 rounded-lg bg-white/5 text-blue-400 flex items-center justify-center hover:bg-blue-600 hover:text-white transition-all shadow-lg border border-white/5"
                                title="Buka Monitor">
                                <svg class="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2.5"
                                        d="M9.75 17L9 20l-1 1h8l-1-1-.75-3M3 13h18M5 17h14a2 2 0 002-2V5a2 2 0 00-2-2H5a2 2 0 00-2 2v10a2 2 0 002 2z" />
                                </svg>
                            </button>
                            <button onclick="closeMonitor()" id="btnCloseMonitor"
                                class="w-10 h-10 rounded-lg bg-white/5 text-red-400 flex items-center justify-center hover:bg-red-600 hover:text-white transition-all shadow-lg border border-white/5"
                                title="Tutup Monitor">
                                <svg class="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2.5"
                                        d="M6 18L18 6M6 6l12 12" />
                                </svg>
                            </button>
                            <button onclick="toggleEventMedia()" id="btnEventMedia"
                                class="w-10 h-10 rounded-lg bg-white/5 text-purple-400 flex items-center justify-center hover:bg-purple-600 hover:text-white transition-all shadow-lg border border-white/5"
                                title="Toggle Event Media">
                                <svg class="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2.5"
                                        d="M15 10l4.553-2.276A1 1 0 0121 8.618v6.764a1 1 0 01-1.447.894L15 14M5 18h8a2 2 0 002-2V8a2 2 0 00-2-2H5a2 2 0 00-2 2v8a2 2 0 002 2z" />
                                </svg>
                            </button>
                            <button onclick="toggleIntro()" id="btnIntro"
                                class="w-10 h-10 rounded-lg bg-white/5 text-pink-400 flex items-center justify-center hover:bg-pink-600 hover:text-white transition-all shadow-lg border border-white/5"
                                title="Pre-Match Intro">
                                <span class="text-[10px] font-black italic">VS</span>
                            </button>
                            <button onclick="toggleSettingsModal()" id="btnOpenSettings"
                                class="w-10 h-10 rounded-lg bg-white/5 text-orange-400 flex items-center justify-center hover:bg-orange-600 hover:text-white transition-all shadow-lg border border-white/5"
                                title="Pengaturan Pertandingan">
                                <svg class="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2.5"
                                        d="M10.325 4.317c.426-1.756 2.924-1.756 3.35 0a1.724 1.724 0 002.573 1.066c1.543-.94 3.31.826 2.37 2.37a1.724 1.724 0 001.065 2.572c1.756.426 1.756 2.924 0 3.35a1.724 1.724 0 00-1.066 2.573c.94 1.543-.826 3.31-2.37 2.37a1.724 1.724 0 00-2.572 1.065c-.426 1.756-2.924 1.756-3.35 0a1.724 1.724 0 00-2.573-1.066c-1.543.94-3.31-.826-2.37-2.37a1.724 1.724 0 00-1.065-2.572c-1.756-.426-1.756-2.924 0-3.35a1.724 1.724 0 001.066-2.573c-.94-1.543.826-3.31 2.37-2.37.996.608 2.296.07 2.572-1.065z" />
                                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2.5"
                                        d="M15 12a3 3 0 11-6 0 3 3 0 016 0z" />
                                </svg>
                            </button>
                        </div>

                        <!-- 3. TIMER DISPLAY CARD -->
                        <div
                            class="relative z-10 w-full bg-white/[0.02] border border-white/5 rounded-[2rem] py-3 px-1.5 flex flex-col items-center shadow-2xl overflow-hidden group">
                            <div
                                class="absolute top-0 left-0 w-full h-0.5 bg-gradient-to-r from-transparent via-blue-500 to-transparent opacity-20">
                            </div>

                            <p class="text-[7px] font-black uppercase tracking-[0.6em] text-white/20 mb-1.5 ml-0.5">
                                TIMER</p>

                            <div class="flex flex-col items-center w-full">
                                <input id="timerDisplay" type="text" value="01:00" onblur="handleTimerBlur(this)"
                                    onkeydown="handleTimerKey(event, this)"
                                    class="text-5xl font-black shimmer-text leading-none w-full text-center bg-transparent focus:outline-none cursor-text select-all drop-shadow-[0_0_10px_rgba(255,255,255,0.08)]">

                                <!-- QUICK ADJUST -->
                                <div
                                    class="flex gap-2 mt-2 opacity-0 group-hover:opacity-100 transition-all duration-500 transform translate-y-2 group-hover:translate-y-0">
                                    <button onclick="adjustTimer(-60)"
                                        class="w-10 h-8 rounded-lg bg-white/5 flex items-center justify-center text-[8px] font-black hover:bg-red-500/20 hover:text-red-400 transition-all border border-white/5 shadow-lg">-1M</button>
                                    <button onclick="adjustTimer(-1)"
                                        class="w-10 h-8 rounded-lg bg-white/5 flex items-center justify-center text-[8px] font-black hover:bg-red-500/20 hover:text-red-400 transition-all border border-white/5 shadow-lg">-1S</button>
                                    <button onclick="adjustTimer(1)"
                                        class="w-10 h-8 rounded-lg bg-white/5 flex items-center justify-center text-[8px] font-black hover:bg-green-500/20 hover:text-green-400 transition-all border border-white/5 shadow-lg">+1S</button>
                                    <button onclick="adjustTimer(60)"
                                        class="w-10 h-8 rounded-lg bg-white/5 flex items-center justify-center text-[8px] font-black hover:bg-green-500/20 hover:text-green-400 transition-all border border-white/5 shadow-lg">+1M</button>
                                </div>
                            </div>

                            <div
                                class="mt-3 flex items-center gap-2 bg-black/40 px-3 py-1.5 rounded-full border border-white/5 shadow-inner">
                                <span id="timerStatusDot"
                                    class="w-2 h-2 rounded-full bg-slate-500 animate-pulse"></span>
                                <p id="timerLabel"
                                    class="text-[8px] font-black uppercase tracking-widest text-slate-400 whitespace-nowrap">
                                    STANDBY</p>
                            </div>
                        </div>

                        <!-- 4. ACTION CONTROLS (TIMER & MATCH) -->
                        <div
                            class="relative z-10 flex items-center justify-center gap-2.5 bg-white/[0.03] p-1.5 rounded-[1.5rem] border border-white/5 shadow-inner">
                            <!-- FINISH MATCH / NEXT -->
                            <button onclick="finishMatch()" id="btnFinishMatch"
                                class="w-11 h-11 rounded-xl bg-emerald-600 text-white flex items-center justify-center shadow-lg hover:scale-110 active:scale-95 transition-all border-t border-white/20"
                                title="Selesaikan Match & Simpan Data">
                                <i id="finishIcon" class="fa-solid fa-check text-xl"></i>
                            </button>

                            <!-- PLAY/PAUSE TIMER -->
                            <button onclick="toggleTimer()" id="btnTimerControl"
                                class="w-11 h-11 rounded-xl bg-red-600 text-white flex items-center justify-center shadow-lg hover:scale-110 active:scale-95 transition-all border-t border-white/20"
                                title="Play/Pause Timer">
                                <svg id="timerIcon" class="w-6 h-6" fill="currentColor" viewBox="0 0 24 24">
                                    <path d="M8 5v14l11-7z" />
                                </svg>
                            </button>

                            <!-- REST TIMER (RES) -->
                            <button onclick="toggleRestTimer(true)" id="btnRestTimerControl"
                                class="w-11 h-11 rounded-xl bg-white/5 text-amber-500/70 flex flex-col items-center justify-center border border-white/10 hover:bg-white/[0.08] hover:text-amber-400 transition-all shadow-lg overflow-hidden"
                                title="Start Rest Timer (RES)">
                                <span id="restCountdownText"
                                    class="hidden text-[10px] font-black leading-none mb-1">00:00</span>
                                <i class="fa-solid fa-clock-rotate-left text-lg"></i>
                            </button>

                            <!-- RESET TIMER ONLY -->
                            <button onclick="resetTimer()" id="btnResetTimerControl"
                                class="w-11 h-11 rounded-xl bg-white/5 text-yellow-500/50 flex items-center justify-center border border-white/10 hover:bg-white/[0.08] hover:text-yellow-400 transition-all shadow-lg"
                                title="Reset Timer Only">
                                <svg class="w-5 h-5" fill="none" stroke="currentColor" stroke-width="2.5"
                                    viewBox="0 0 24 24">
                                    <path stroke-linecap="round" stroke-linejoin="round"
                                        d="M12 6v6h4.5m4.5 0a9 9 0 11-18 0 9 9 0 0118 0z" />
                                </svg>
                            </button>

                            <!-- RESET FULL MATCH -->
                            <button onclick="resetMatch()" id="btnResetControl"
                                class="w-11 h-11 rounded-xl bg-white/5 text-slate-400 flex items-center justify-center border border-white/10 hover:bg-white/[0.08] hover:text-white transition-all shadow-lg"
                                title="Reset Full Match (Scores, Penalties & Timer)">
                                <svg class="w-6 h-6" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2.5"
                                        d="M4 4v5h.582m15.356 2A8.001 8.001 0 004.582 9m0 0H9m11 11v-5h-.581m0 0a8.003 8.003 0 01-15.357-2m15.357 2H15" />
                                </svg>
                            </button>
                        </div>

                        <!-- 5. MODE SPECIFIC CONTROLS (DYNAMIC) -->
                        <div class="relative z-10 w-full flex flex-col gap-2">

                            <!-- TIMER QUICK TOGGLE (KATA ONLY) -->
                            <div id="timerToggleContainer"
                                class="hidden flex items-center justify-between w-full px-4 py-2.5 bg-white/[0.03] rounded-[1.5rem] border border-white/5 shadow-inner">
                                <div class="flex items-center gap-2">
                                    <div id="timerToggleStatus"
                                        class="w-2 h-2 rounded-full bg-red-500 shadow-[0_0_8px_rgba(239,68,68,0.5)]">
                                    </div>
                                    <p class="text-[8px] font-black uppercase tracking-widest text-slate-400">AUTO TIMER
                                    </p>
                                </div>
                                <label class="relative inline-flex items-center cursor-pointer">
                                    <input type="checkbox" id="timerEnableSwitch" class="sr-only peer" checked
                                        onchange="toggleTimerSetting(this.checked)">
                                    <div
                                        class="w-9 h-5 bg-slate-700 peer-focus:outline-none rounded-full peer peer-checked:after:translate-x-full peer-checked:after:border-white after:content-[''] after:absolute after:top-[2px] after:left-[2px] after:bg-white after:border-gray-300 after:border after:rounded-full after:h-4 after:w-4 after:transition-all peer-checked:bg-red-600">
                                    </div>
                                </label>
                            </div>

                            <!-- CONSOLIDATED KATA CONTROLS ROW -->
                            <div id="consolidatedKataControls"
                                class="hidden w-full flex flex-row items-stretch gap-3 p-3 bg-white/[0.03] rounded-[2rem] border border-white/5 shadow-inner">

                                <!-- KATA MODE SELECTOR -->
                                <div class="flex-none flex flex-col items-center gap-1.5 min-w-[80px]">
                                    <p class="text-[7px] font-black uppercase tracking-[0.2em] text-slate-500">MODE</p>
                                    <div id="kataTypeSwitch"
                                        class="flex w-full h-10 bg-white/[0.02] p-1 rounded-xl border border-white/5 shadow-inner">
                                        <button id="kataTypeScoreBtn" onclick="setKataType('score')"
                                            class="flex-1 rounded-lg text-[8px] font-black uppercase transition-all mode-active"
                                            title="Score Points">1.0</button>
                                        <button id="kataTypeFlagBtn" onclick="setKataType('flag')"
                                            class="flex-1 rounded-lg text-[10px] font-black transition-all text-slate-500"
                                            title="Flag Voting">üö©</button>
                                    </div>
                                </div>

                                <div class="w-[1px] h-14 bg-white/10 shrink-0 self-center"></div>

                                <!-- KATA PERFORMER SELECTOR -->
                                <div class="flex-none flex flex-col items-center gap-1.5 min-w-[100px]">
                                    <p class="text-[7px] font-black uppercase tracking-[0.2em] text-slate-500">PLAYER
                                    </p>
                                    <div id="performerSelector" class="flex gap-1.5 w-full h-10">
                                        <button id="performerAkaBtn" onclick="setKataPerformer('aka')"
                                            class="flex-1 rounded-lg bg-white/5 text-red-500 flex items-center justify-center hover:text-white transition-all border border-white/5 shadow-md">
                                            <svg class="w-5 h-5" fill="currentColor" viewBox="0 0 24 24">
                                                <path
                                                    d="M12 12c2.21 0 4-1.79 4-4s-1.79-4-4-4-4 1.79-4 4 1.79 4 4 4zm0 2c-2.67 0-8 1.34-8 4v2h16v-2c0-2.66-5.33-4-8-4z" />
                                            </svg>
                                        </button>
                                        <button id="performerAoBtn" onclick="setKataPerformer('ao')"
                                            class="flex-1 rounded-lg bg-white/5 text-blue-500 flex items-center justify-center hover:text-white transition-all border border-white/5 shadow-md">
                                            <svg class="w-5 h-5" fill="currentColor" viewBox="0 0 24 24">
                                                <path
                                                    d="M12 12c2.21 0 4-1.79 4-4s-1.79-4-4-4-4 1.79-4 4 1.79 4 4 4zm0 2c-2.67 0-8 1.34-8 4v2h16v-2c0-2.66-5.33-4-8-4z" />
                                            </svg>
                                        </button>
                                    </div>
                                </div>
                            </div>

                            <!-- HANTEI FLAG CONTROLS (Hidden by default, shows on draw) -->
                            <div id="hanteiControls"
                                class="hidden w-full flex flex-col gap-3 p-4 bg-yellow-500/10 rounded-[2rem] border border-yellow-500/30 shadow-inner">
                                <p class="text-[8px] font-black uppercase tracking-[0.3em] text-yellow-500 text-center">
                                    ‚öñÔ∏è HANTEI - KEPUTUSAN WASIT ‚öñÔ∏è
                                </p>
                                <div class="flex items-center justify-center gap-6">
                                    <!-- AKA FLAGS INPUT -->
                                    <div class="flex flex-col items-center gap-1">
                                        <p class="text-[7px] font-black uppercase text-red-500">AKA</p>
                                        <input type="number" id="hanteiInputAka" min="0" max="5" value="0"
                                            onchange="checkHanteiResult()"
                                            class="w-14 h-12 text-center text-2xl font-black bg-red-500/20 text-red-500 border-2 border-red-500/50 rounded-xl focus:outline-none focus:border-red-500 transition-all" />
                                    </div>
                                    <span class="text-2xl font-black text-yellow-500/50">-</span>
                                    <!-- AO FLAGS INPUT -->
                                    <div class="flex flex-col items-center gap-1">
                                        <p class="text-[7px] font-black uppercase text-blue-500">AO</p>
                                        <input type="number" id="hanteiInputAo" min="0" max="5" value="0"
                                            onchange="checkHanteiResult()"
                                            class="w-14 h-12 text-center text-2xl font-black bg-blue-500/20 text-blue-500 border-2 border-blue-500/50 rounded-xl focus:outline-none focus:border-blue-500 transition-all" />
                                    </div>
                                </div>
                                <button onclick="confirmHantei()" id="btnConfirmHantei"
                                    class="w-full py-2 rounded-xl bg-yellow-500 text-black text-[9px] font-black uppercase tracking-widest hover:bg-yellow-400 active:scale-95 transition-all shadow-lg">
                                    Konfirmasi Pemenang
                                </button>
                            </div>

                        </div>

                        <!-- FOOTER INFO -->
                        <div class="mt-auto pt-2 text-center opacity-5">
                            <p class="text-[6px] font-black uppercase tracking-[0.8em]">KENSHO SCORING SYSTEM</p>
                        </div>
                    </div>

                    <!-- AO PANEL (Default: LEFT side to match monitor) -->
                    <div id="panelContainerAo" style="order: 1; flex: 1.5;"
                        class="col-span-12 md:col-span-5 flex flex-col items-center justify-between py-6 px-8 bg-blue-950/20 relative group border-r border-white/5 premium-gradient-blue overflow-hidden">
                        <!-- DECORATIVE GLOW -->
                        <div
                            class="absolute -top-24 -left-24 w-48 h-48 bg-blue-600/10 blur-[80px] rounded-full pointer-events-none">
                        </div>

                        <!-- HANTEI BUTTON (Minimalist) -->
                        <button id="btnHanteiAo" onclick="setHanteiWinner('ao')"
                            class="absolute top-0 left-0 px-6 py-2.5 bg-blue-600 shadow-[0_8px_20px_rgba(37,99,235,0.4)] text-white rounded-br-[2rem] border-r border-b border-white/20 hidden transition-all hover:scale-105 active:scale-95 z-50">
                            <span class="text-[10px] font-black tracking-[0.2em] uppercase">Kachi</span>
                        </button>

                        <div
                            class="absolute top-0 left-0 w-full h-1.5 bg-gradient-to-r from-blue-600 to-transparent shadow-[0_5px_20px_rgba(37,99,235,0.4)]">
                        </div>

                        <!-- TOP: Name & Label -->
                        <div id="panelAo" class="text-center w-full relative z-10">
                            <p class="text-[11px] font-black uppercase tracking-[0.5em] text-blue-500/50 mb-1.5">
                                AO</p>
                            <h2 id="nameAoDisplay"
                                class="text-3xl font-black uppercase tracking-tight text-white truncate px-4 drop-shadow-lg">
                                ---</h2>
                            <p id="teamAoDisplay"
                                class="text-[11px] font-black uppercase text-white/80 tracking-[0.2em] mt-1 truncate px-10">
                                ---</p>
                            <input type="text" id="inputKataAo" placeholder="Input Nama Kata"
                                oninput="checkKataShortcut(this)" onchange="broadcastData()"
                                class="w-auto min-w-[200px] bg-blue-500/10 border border-blue-500/20 rounded-2xl px-6 py-3 text-xs font-black uppercase tracking-widest text-blue-400 mt-3 focus:bg-blue-500/20 focus:border-blue-500/50 focus:scale-105 focus:outline-none placeholder:text-blue-500/30 transition-all text-center hidden shadow-inner">
                        </div>

                        <!-- CENTER: Score (Anchor) -->
                        <div id="scoreAo"
                            class="text-[180px] score-digit text-blue-500 leading-none drop-shadow-[0_20px_60px_rgba(59,130,246,0.4)] select-none my-auto transition-all duration-300">
                            00</div>

                        <!-- BOTTOM: Controls -->
                        <div id="kumiteControlsAo" class="w-full relative z-10 space-y-4 px-4">
                            <!-- Score Buttons -->
                            <div class="grid grid-cols-4 gap-3">
                                <button onclick="addScore('ao', 1)"
                                    class="neu-button py-4 rounded-2xl group border-white/10">
                                    <span
                                        class="text-2xl font-black group-hover:scale-110 transition-transform text-blue-400">+1</span>
                                </button>
                                <button onclick="addScore('ao', 2)"
                                    class="neu-button py-4 rounded-2xl group border-blue-500/30">
                                    <span
                                        class="text-2xl font-black text-blue-500 group-hover:scale-110 transition-transform">+2</span>
                                </button>
                                <button onclick="addScore('ao', 3)"
                                    class="neu-button py-4 rounded-2xl group border-blue-500/50">
                                    <span
                                        class="text-2xl font-black text-blue-600 group-hover:scale-110 transition-transform">+3</span>
                                </button>
                                <button onclick="addScore('ao', -1)"
                                    class="neu-button py-4 rounded-2xl group bg-white/5 opacity-40 border-white/5">
                                    <span
                                        class="text-2xl font-black text-slate-500 group-hover:scale-110 transition-transform">-1</span>
                                </button>
                            </div>

                            <!-- Penalty & Status Buttons -->
                            <div id="penAo" class="grid grid-cols-7 gap-1.5 md:gap-2">
                                <button id="senshuAo" onclick="setSenshu('ao')"
                                    class="py-4 rounded-xl neu-button text-[12px] font-black opacity-70 hover:opacity-100 transition-opacity">S</button>
                                <button onclick="togglePenalty('ao', 'c1')" id="c1Ao"
                                    class="penalty-btn neu-button py-4 rounded-xl text-[12px] font-black opacity-40">C1</button>
                                <button onclick="togglePenalty('ao', 'c2')" id="c2Ao"
                                    class="penalty-btn neu-button py-4 rounded-xl text-[12px] font-black opacity-40">C2</button>
                                <button onclick="togglePenalty('ao', 'c3')" id="c3Ao"
                                    class="penalty-btn neu-button py-4 rounded-xl text-[12px] font-black opacity-40">C3</button>
                                <button onclick="togglePenalty('ao', 'hc')" id="hcAo"
                                    class="penalty-btn neu-button py-4 rounded-xl text-[12px] font-black opacity-40">HC</button>
                                <button onclick="togglePenalty('ao', 'h')" id="hAo"
                                    class="penalty-btn neu-button py-4 rounded-xl text-[12px] font-black opacity-40">H</button>
                                <button id="vrAo" onclick="toggleVR('ao')"
                                    class="py-4 rounded-xl neu-button text-[12px] font-black opacity-50 text-yellow-500 transition-all hover:opacity-100">VR</button>
                            </div>
                        </div>

                        <!-- KATA CONTROLS AO (Integrated) -->
                        <div id="kataControlsAo" class="hidden w-full relative z-10 space-y-4 px-2">
                            <div class="grid grid-cols-5 gap-3">
                                <input type="text" id="judgeBtnAo0" value="0.0"
                                    oninput="window.updateKataJudgeScoreManual(this, 'ao', 0)" onfocus="this.select()"
                                    inputmode="decimal"
                                    class="oled-panel rounded-2xl py-4 text-center text-lg font-black text-blue-500 hover:glow-blue focus:glow-blue focus:ring-2 focus:ring-blue-500/50 outline-none transition-all bg-transparent">
                                <input type="text" id="judgeBtnAo1" value="0.0"
                                    oninput="window.updateKataJudgeScoreManual(this, 'ao', 1)" onfocus="this.select()"
                                    inputmode="decimal"
                                    class="oled-panel rounded-2xl py-4 text-center text-lg font-black text-blue-500 hover:glow-blue focus:glow-blue focus:ring-2 focus:ring-blue-500/50 outline-none transition-all bg-transparent">
                                <input type="text" id="judgeBtnAo2" value="0.0"
                                    oninput="window.updateKataJudgeScoreManual(this, 'ao', 2)" onfocus="this.select()"
                                    inputmode="decimal"
                                    class="oled-panel rounded-2xl py-4 text-center text-lg font-black text-blue-500 hover:glow-blue focus:glow-blue focus:ring-2 focus:ring-blue-500/50 outline-none transition-all bg-transparent">
                                <input type="text" id="judgeBtnAo3" value="0.0"
                                    oninput="window.updateKataJudgeScoreManual(this, 'ao', 3)" onfocus="this.select()"
                                    inputmode="decimal"
                                    class="oled-panel rounded-2xl py-4 text-center text-lg font-black text-blue-500 hover:glow-blue focus:glow-blue focus:ring-2 focus:ring-blue-500/50 outline-none transition-all bg-transparent">
                                <input type="text" id="judgeBtnAo4" value="0.0"
                                    oninput="window.updateKataJudgeScoreManual(this, 'ao', 4)" onfocus="this.select()"
                                    inputmode="decimal"
                                    class="oled-panel rounded-2xl py-4 text-center text-lg font-black text-blue-500 hover:glow-blue focus:glow-blue focus:ring-2 focus:ring-blue-500/50 outline-none transition-all bg-transparent">
                            </div>
                            <div
                                class="p-3.5 rounded-2xl bg-blue-600/10 border border-blue-500/20 flex justify-between items-center shadow-inner">
                                <div class="flex flex-col">
                                    <span
                                        class="text-[10px] font-black uppercase tracking-[0.2em] text-blue-500/50">TOTAL
                                        SCORE</span>
                                    <button onclick="window.checkKataAutoWinner()"
                                        class="text-[8px] font-black text-blue-500/80 hover:text-blue-400 text-left">AUTO-CALC</button>
                                </div>
                                <span id="kataTotalAo" class="text-2xl font-black text-blue-500 score-digit">0.0</span>
                            </div>
                        </div>
                        <!-- KATA FLAG CONTROLS AO -->
                        <div id="kataFlagControlsAo" class="hidden w-full relative z-10 space-y-3 px-4">
                            <p class="text-[8px] font-black uppercase tracking-widest text-blue-500/50 text-center">
                                VOTING BENDERA AO</p>
                            <div class="grid grid-cols-6 gap-2">
                                <button onclick="setKataFlagsAo(0)"
                                    class="flag-btn-ao py-3 rounded-xl bg-white/5 text-blue-500 text-lg font-black border border-white/10 hover:border-blue-500 hover:bg-blue-500/20 transition-all"
                                    data-val="0">0</button>
                                <button onclick="setKataFlagsAo(1)"
                                    class="flag-btn-ao py-3 rounded-xl bg-white/5 text-blue-500 text-lg font-black border border-white/10 hover:border-blue-500 hover:bg-blue-500/20 transition-all"
                                    data-val="1">1</button>
                                <button onclick="setKataFlagsAo(2)"
                                    class="flag-btn-ao py-3 rounded-xl bg-white/5 text-blue-500 text-lg font-black border border-white/10 hover:border-blue-500 hover:bg-blue-500/20 transition-all"
                                    data-val="2">2</button>
                                <button onclick="setKataFlagsAo(3)"
                                    class="flag-btn-ao py-3 rounded-xl bg-white/5 text-blue-500 text-lg font-black border border-white/10 hover:border-blue-500 hover:bg-blue-500/20 transition-all"
                                    data-val="3">3</button>
                                <button onclick="setKataFlagsAo(4)"
                                    class="flag-btn-ao py-3 rounded-xl bg-white/5 text-blue-500 text-lg font-black border border-white/10 hover:border-blue-500 hover:bg-blue-500/20 transition-all"
                                    data-val="4">4</button>
                                <button onclick="setKataFlagsAo(5)"
                                    class="flag-btn-ao py-3 rounded-xl bg-white/5 text-blue-500 text-lg font-black border border-white/10 hover:border-blue-500 hover:bg-blue-500/20 transition-all"
                                    data-val="5">5</button>
                            </div>
                        </div>
                    </div>
                </div>



            </div> <!-- End of scoringMainArea -->


        </div> <!-- End of mainScoringGrid -->

        <!-- PARTICIPANT LIST MODAL -->
        <div id="participantModal"
            class="fixed inset-0 bg-black/80 backdrop-blur-sm flex items-center justify-center z-50 hidden">
            <div
                class="glass-card rounded-[3rem] w-[90vw] max-w-5xl max-h-[85vh] flex flex-col overflow-hidden shadow-2xl border border-white/10">
                <!-- Modal Header -->
                <div class="flex justify-between items-center p-6 border-b border-white/10">
                    <div>
                        <h2 class="text-2xl font-black tracking-tight uppercase text-white mb-1">List Peserta
                        </h2>
                        <p class="text-[9px] font-bold uppercase tracking-widest text-slate-500">Kelas Tanding Aktif</p>
                    </div>
                    <div class="flex items-center gap-4">
                        <span id="participantCountModal"
                            class="text-xs font-bold text-slate-400 bg-white/5 px-4 py-2 rounded-full border border-white/5">
                            0 Peserta
                        </span>
                        <button onclick="toggleParticipantModal()"
                            class="w-10 h-10 rounded-xl bg-red-500/10 border border-red-500/20 flex items-center justify-center text-red-500 hover:bg-red-500/20 transition-all">
                            <svg class="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2"
                                    d="M6 18L18 6M6 6l12 12" />
                            </svg>
                        </button>
                    </div>
                </div>

                <!-- Modal Body -->
                <div class="flex-1 overflow-y-auto p-6">
                    <table class="w-full">
                        <thead class="sticky top-0 bg-slate-900/80 backdrop-blur-md">
                            <tr class="border-b border-white/10">
                                <th
                                    class="text-left py-3 px-4 text-[9px] font-black uppercase tracking-[0.2em] text-slate-500">
                                    Partai</th>
                                <th
                                    class="text-left py-3 px-4 text-[9px] font-black uppercase tracking-[0.2em] text-slate-500">
                                    Peserta AKA</th>
                                <th
                                    class="text-center py-3 px-2 text-[9px] font-black uppercase tracking-[0.2em] text-slate-500">
                                    VS</th>
                                <th
                                    class="text-left py-3 px-4 text-[9px] font-black uppercase tracking-[0.2em] text-slate-500">
                                    Peserta AO</th>
                                <th
                                    class="text-center py-3 px-4 text-[9px] font-black uppercase tracking-[0.2em] text-slate-500">
                                    Action</th>
                            </tr>
                        </thead>
                        <tbody id="participantTableModal">
                            <tr>
                                <td colspan="6"
                                    class="py-12 text-center text-[10px] font-bold uppercase tracking-widest text-slate-600">
                                    Pilih kelas dari Pengaturan Pertandingan
                                </td>
                            </tr>
                        </tbody>
                    </table>
                </div>
            </div>
        </div>



    </main>

    <!-- CUSTOM MODAL HTML -->
    <div id="customModal">
        <div class="modal-content">
            <div class="w-16 h-16 bg-red-500/10 rounded-2xl flex items-center justify-center mx-auto mb-6">
                <svg class="w-8 h-8 text-red-500" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2"
                        d="M12 9v2m0 4h.01m-6.938 4h13.856c1.54 0 2.502-1.667 1.732-3L13.732 4c-.77-1.333-2.694-1.333-3.464 0L3.34 16c-.77 1.333.192 3 1.732 3z" />
                </svg>
            </div>
            <h3 id="modalTitle" class="text-xl font-black uppercase tracking-widest text-white mb-2">Konfirmasi</h3>
            <p id="modalMessage" class="text-sm font-medium text-slate-400 leading-relaxed mb-8">Apakah Anda yakin ingin
                mengganti pertandingan?</p>
            <div class="flex gap-4">
                <button id="modalCancel"
                    class="flex-1 py-3 rounded-xl neu-button text-[10px] font-black uppercase tracking-widest text-slate-500">Batal</button>
                <button id="modalConfirm"
                    class="flex-1 py-3 rounded-xl bg-red-500 text-white text-[10px] font-black uppercase tracking-widest shadow-[0_8px_15px_rgba(248,113,113,0.3)]">Lanjutkan</button>
            </div>
        </div>
    </div>

    <!-- SETTINGS MODAL -->
    <div id="settingsModal"
        class="fixed inset-0 z-[100] hidden items-center justify-center p-4 bg-slate-950/80 backdrop-blur-md transition-all duration-300">
        <div class="bg-slate-900/90 border border-white/10 rounded-[2.5rem] w-full max-w-lg p-8 neu-flat animate-pop">
            <h3 class="text-xl font-black uppercase tracking-widest text-white mb-6 shimmer-text">Pengaturan
                Pertandingan</h3>

            <div class="space-y-6">
                <div class="autocomplete-container">
                    <label class="block text-[8px] font-black uppercase tracking-[0.4em] text-white/30 mb-2 ml-1">Nama
                        Kelas / Kategori</label>
                    <input type="text" id="inputCategory" placeholder="Cari Kelas... (Contoh: Male Kumite)"
                        autocomplete="off" onfocus="showCategoryDropdown()" oninput="filterCategories(this.value)"
                        class="w-full bg-black/40 border border-white/10 rounded-2xl px-6 py-4 text-sm font-bold text-white focus:border-red-500/50 focus:bg-black/60 outline-none transition-all">

                    <div id="categoryDropdown" class="custom-scrollbar">
                        <!-- Items dynamically populated -->
                    </div>
                </div>

                <!-- ATHLETE INPUTS -->
                <div class="grid grid-cols-2 gap-4">
                    <!-- AKA SIDE -->
                    <div class="space-y-3">
                        <label class="block text-[8px] font-black uppercase tracking-[0.4em] text-red-500 mb-2 ml-1">üî¥
                            AKA / RED</label>

                        <div class="relative">
                            <label
                                class="block text-[7px] font-bold uppercase tracking-wider text-white/30 mb-1 ml-1">Nama
                                Atlet</label>
                            <input type="text" id="inputNameAka" placeholder="Ketik nama..."
                                oninput="filterAthletes('aka')" onfocus="showAthleteDropdown('aka')" autocomplete="off"
                                class="w-full bg-black/40 border border-red-500/20 rounded-xl px-4 py-3 text-xs font-bold text-white focus:border-red-500/50 focus:bg-black/60 outline-none transition-all">
                            <div id="athleteDropdownAka"
                                class="hidden absolute top-full left-0 right-0 mt-1 bg-slate-900/95 backdrop-blur-xl border border-red-500/30 rounded-xl max-h-40 overflow-y-auto custom-scrollbar shadow-2xl z-50">
                            </div>
                        </div>

                        <div>
                            <label
                                class="block text-[7px] font-bold uppercase tracking-wider text-white/30 mb-1 ml-1">Kontingen</label>
                            <input type="text" id="inputTeamAka" placeholder="Team AKA"
                                class="w-full bg-black/40 border border-red-500/20 rounded-xl px-4 py-3 text-xs font-bold text-white focus:border-red-500/50 focus:bg-black/60 outline-none transition-all">
                        </div>
                    </div>

                    <!-- AO SIDE -->
                    <div class="space-y-3">
                        <label class="block text-[8px] font-black uppercase tracking-[0.4em] text-blue-500 mb-2 ml-1">üîµ
                            AO / BLUE</label>

                        <div class="relative">
                            <label
                                class="block text-[7px] font-bold uppercase tracking-wider text-white/30 mb-1 ml-1">Nama
                                Atlet</label>
                            <input type="text" id="inputNameAo" placeholder="Ketik nama..."
                                oninput="filterAthletes('ao')" onfocus="showAthleteDropdown('ao')" autocomplete="off"
                                class="w-full bg-black/40 border border-blue-500/20 rounded-xl px-4 py-3 text-xs font-bold text-white focus:border-blue-500/50 focus:bg-black/60 outline-none transition-all">
                            <div id="athleteDropdownAo"
                                class="hidden absolute top-full left-0 right-0 mt-1 bg-slate-900/95 backdrop-blur-xl border border-blue-500/30 rounded-xl max-h-40 overflow-y-auto custom-scrollbar shadow-2xl z-50">
                            </div>
                        </div>

                        <div>
                            <label
                                class="block text-[7px] font-bold uppercase tracking-wider text-white/30 mb-1 ml-1">Kontingen</label>
                            <input type="text" id="inputTeamAo" placeholder="Team AO"
                                class="w-full bg-black/40 border border-blue-500/20 rounded-xl px-4 py-3 text-xs font-bold text-white focus:border-blue-500/50 focus:bg-black/60 outline-none transition-all">
                        </div>
                    </div>
                </div>

                <!-- EVENT MEDIA SECTION -->
                <div class="pt-6 mt-6 border-t border-white/10">
                    <label class="block text-[8px] font-black uppercase tracking-[0.4em] text-purple-500 mb-3 ml-1">üé¨
                        EVENT MEDIA (STANDBY DISPLAY)</label>

                    <div class="space-y-3">
                        <!-- Upload Button -->
                        <div class="relative">
                            <input type="file" id="eventMediaInput" accept="video/*,image/*"
                                onchange="handleEventMediaUpload(this)" class="hidden">
                            <button onclick="document.getElementById('eventMediaInput').click()" type="button"
                                class="w-full py-3 rounded-xl bg-purple-600/10 border border-purple-500/30 text-purple-400 text-[10px] font-black uppercase tracking-widest hover:bg-purple-600/20 transition-all flex items-center justify-center gap-2">
                                <svg class="w-4 h-4" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2.5"
                                        d="M7 16a4 4 0 01-.88-7.903A5 5 0 1115.9 6L16 6a5 5 0 011 9.9M15 13l-3-3m0 0l-3 3m3-3v12" />
                                </svg>
                                Upload Video/Foto
                            </button>
                        </div>

                        <!-- Preview -->
                        <div id="mediaPreviewContainer"
                            class="hidden bg-black/40 rounded-xl p-3 border border-purple-500/20">
                            <p class="text-[7px] font-black uppercase tracking-wider text-purple-500/50 mb-2">Preview:
                            </p>
                            <div id="mediaPreview"
                                class="w-full h-32 bg-black/60 rounded-lg flex items-center justify-center overflow-hidden">
                                <!-- Preview will be inserted here -->
                            </div>
                            <button onclick="clearEventMedia()" type="button"
                                class="w-full mt-2 py-2 rounded-lg bg-red-500/10 border border-red-500/30 text-red-400 text-[8px] font-black uppercase tracking-widest hover:bg-red-500/20 transition-all">
                                Hapus Media
                            </button>
                        </div>
                    </div>
                </div>

            </div>

            <div class="flex gap-4 mt-10">
                <button onclick="toggleSettingsModal()"
                    class="flex-1 py-4 rounded-xl neu-button text-[10px] font-black uppercase tracking-widest text-slate-500">Tutup</button>
                <button type="button" id="btnSaveSettings" onclick="saveMatchSettings()"
                    class="flex-1 py-4 rounded-xl bg-red-600 text-white text-[10px] font-black uppercase tracking-widest shadow-[0_10px_20px_rgba(220,38,38,0.3)]">Simpan
                    Pengaturan</button>
            </div>
        </div>
    </div>

    <!-- JUDGE KEYPAD MODAL -->
    <div id="judgeKeypadModal"
        class="fixed inset-0 z-[110] hidden items-center justify-center p-4 bg-slate-950/95 backdrop-blur-2xl transition-all duration-300">
        <div
            class="bg-slate-900/40 border border-white/10 rounded-[3.5rem] w-full max-w-5xl p-1 md:p-12 shadow-[0_0_100px_rgba(0,0,0,0.8)] overflow-hidden max-h-[92vh] flex flex-col relative">

            <!-- DECORATIVE BG GLOW -->
            <div id="keypadGlow"
                class="absolute -top-40 -left-40 w-80 h-80 bg-red-500/10 blur-[100px] rounded-full pointer-events-none transition-all duration-500">
            </div>

            <div class="flex justify-between items-start mb-10 px-6 pt-6 md:pt-0">
                <div>
                    <h3 class="text-3xl font-black uppercase tracking-tight text-white shimmer-text">INPUT NILAI
                        KATA</h3>
                    <div id="keypadSubtitleContainer" class="flex items-center gap-3 mt-2">
                        <span id="keypadBadge"
                            class="px-3 py-1 bg-red-500/20 text-red-500 text-[10px] font-black uppercase tracking-widest rounded-full border border-red-500/30">AKA</span>
                        <p id="keypadSubtitle" class="text-[11px] font-black uppercase tracking-[0.3em] text-slate-400">
                            JUDGE 1</p>
                    </div>
                </div>
                <button onclick="closeJudgeKeypad()"
                    class="w-14 h-14 rounded-2xl bg-white/5 border border-white/10 flex items-center justify-center text-slate-400 hover:text-white hover:bg-white/10 hover:scale-110 active:scale-95 transition-all shadow-xl">
                    <svg class="w-7 h-7" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2.5"
                            d="M6 18L18 6M6 6l12 12" />
                    </svg>
                </button>
            </div>

            <div id="keypadGrid"
                class="flex-1 overflow-y-auto px-6 pb-6 custom-scrollbar flex flex-col items-center justify-center space-y-8">
                <!-- Display Area -->
                <div class="flex items-center gap-6">
                    <div id="digitPrimer"
                        class="w-24 h-32 rounded-3xl bg-white/5 border-2 border-white/10 flex items-center justify-center text-7xl font-black text-white shadow-inner">
                        _</div>
                    <div class="text-6xl font-black text-white/20">.</div>
                    <div id="digitDecimal"
                        class="w-24 h-32 rounded-3xl bg-white/5 border-2 border-white/10 flex items-center justify-center text-7xl font-black text-white shadow-inner">
                        _</div>
                </div>

                <!-- Numpad Area -->
                <div class="grid grid-cols-3 gap-4 md:gap-6 max-w-sm w-full">
                    <button onclick="handleNumpad(1)" class="numpad-btn">1</button>
                    <button onclick="handleNumpad(2)" class="numpad-btn">2</button>
                    <button onclick="handleNumpad(3)" class="numpad-btn">3</button>
                    <button onclick="handleNumpad(4)" class="numpad-btn">4</button>
                    <button onclick="handleNumpad(5)" class="numpad-btn">5</button>
                    <button onclick="handleNumpad(6)" class="numpad-btn">6</button>
                    <button onclick="handleNumpad(7)" class="numpad-btn">7</button>
                    <button onclick="handleNumpad(8)" class="numpad-btn">8</button>
                    <button onclick="handleNumpad(9)" class="numpad-btn">9</button>
                    <div class="invisible"></div>
                    <button onclick="handleNumpad(0)" class="numpad-btn">0</button>
                    <button onclick="clearNumpad()" class="numpad-btn text-red-500 text-sm">CLR</button>
                </div>
            </div>

            <style>
                .numpad-btn {
                    width: 100%;
                    aspect-ratio: 1 / 1;
                    border-radius: 1.5rem;
                    background-color: rgba(255, 255, 255, 0.05);
                    border: 1px solid rgba(255, 255, 255, 0.1);
                    display: flex;
                    align-items: center;
                    justify-content: center;
                    font-size: 1.875rem;
                    font-weight: 900;
                    color: white;
                    transition: all 0.2s;
                    box-shadow: 0 20px 25px -5px rgba(0, 0, 0, 0.1), 0 10px 10px -5px rgba(0, 0, 0, 0.04);
                }

                @media (min-width: 768px) {
                    .numpad-btn {
                        width: 6rem;
                        height: 6rem;
                    }
                }

                .numpad-btn:hover {
                    background-color: rgba(255, 255, 255, 0.1);
                    transform: scale(1.05);
                }

                .numpad-btn:active {
                    transform: scale(0.95);
                }

                .digit-active {
                    border-color: rgba(239, 68, 68, 0.5) !important;
                    background-color: rgba(239, 68, 68, 0.05) !important;
                    box-shadow: 0 0 30px rgba(239, 68, 68, 0.2) !important;
                }
            </style>

            <script type="module" src="js/scoring.js"></script>

            <!-- Footer indicator -->
            <div class="p-6 border-t border-white/5 text-center">
                <p class="text-[9px] font-black uppercase tracking-[0.5em] text-slate-600">KENSHO SCORING SYSTEM ‚Ä¢
                    PREMIUM EDITION</p>
            </div>
        </div>
    </div>


    <style>
        .custom-scrollbar::-webkit-scrollbar {
            width: 4px;
        }

        .custom-scrollbar::-webkit-scrollbar-track {
            background: transparent;
        }

        .custom-scrollbar::-webkit-scrollbar-thumb {
            background: rgba(255, 255, 255, 0.05);
            border-radius: 10px;
        }

        .custom-scrollbar::-webkit-scrollbar-thumb:hover {
            background: var(--accent);
        }

        .tab-active {
            box-shadow: inset 4px 4px 8px var(--dark), inset -4px -4px 8px var(--light) !important;
        }

        .punish-dot.opacity-100 {
            transform: scale(1.1);
            border: 1px solid rgba(255, 255, 255, 0.3);
        }

        /* Active Penalty Button Style (Simulated) */
        .neu-button:active,
        .neu-button.penalty-active {
            box-shadow: inset 2px 2px 5px var(--dark), inset -2px -2px 5px var(--light) !important;
            color: white !important;
        }

        /* MODAL STYLES */
        #timerModal {
            display: none;
            backdrop-filter: blur(8px);
            background: rgba(0, 0, 0, 0.4);
        }

        .modal-show {
            display: flex !important;
            animation: fadeIn 0.3s ease-out;
        }

        /* Kata Discarded Score Style */
        .kata-discarded {
            text-decoration: line-through;
            opacity: 0.3;
            filter: grayscale(1);
            position: relative;
        }

        .kata-discarded::after {
            content: '';
            position: absolute;
            top: 50%;
            left: 10%;
            right: 10%;
            height: 2px;
            background: currentColor;
            transform: rotate(-15deg);
        }

        @keyframes fadeIn {
            from {
                opacity: 0;
            }

            to {
                opacity: 1;
            }
        }

        /* TOGGLE SWITCH */
        .switch {
            position: relative;
            display: inline-block;
            width: 44px;
            height: 24px;
        }

        .switch input {
            opacity: 0;
            width: 0;
            height: 0;
        }

        .slider {
            position: absolute;
            cursor: pointer;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background-color: var(--light);
            transition: .4s;
            border-radius: 24px;
            box-shadow: inset 2px 2px 5px var(--dark);
        }

        .slider:before {
            position: absolute;
            content: "";
            height: 18px;
            width: 18px;
            left: 3px;
            bottom: 3px;
            background-color: var(--text);
            transition: .4s;
            border-radius: 50%;
        }

        input:checked+.slider {
            background-color: var(--accent);
        }

        input:checked+.slider:before {
            transform: translateX(20px);
        }

        /* SEARCHABLE DROPDOWN STYLES */
        .autocomplete-container {
            position: relative;
            width: 100%;
        }

        #categoryDropdown {
            position: absolute;
            top: 100%;
            left: 0;
            right: 0;
            background: rgba(15, 23, 42, 0.95);
            backdrop-filter: blur(20px);
            border: 1px solid rgba(255, 255, 255, 0.1);
            border-radius: 1rem;
            margin-top: 0.5rem;
            max-height: 200px;
            overflow-y: auto;
            z-index: 1000;
            display: none;
            box-shadow: 0 10px 25px -5px rgba(0, 0, 0, 0.3), 0 8px 10px -6px rgba(0, 0, 0, 0.3);
            animation: slideDown 0.2s ease-out;
        }

        #categoryDropdown.active {
            display: block;
        }

        .dropdown-item {
            padding: 1rem 1.5rem;
            cursor: pointer;
            transition: all 0.2s;
            border-bottom: 1px solid rgba(255, 255, 255, 0.05);
        }

        .dropdown-item:last-child {
            border-bottom: none;
        }

        .dropdown-item:hover {
            background: rgba(255, 255, 255, 0.05);
            color: #ef4444;
        }

        @keyframes slideDown {
            from {
                opacity: 0;
                transform: translateY(-10px);
            }

            to {
                opacity: 1;
                transform: translateY(0);
            }
        }

        /* ========================= */
    </style>

    <script src="js/event-media.js"></script>
</body>

</html>